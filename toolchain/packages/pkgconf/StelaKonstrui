##############################################
#--------------------------------------------#
# StelaKonstrui Script - pkgconf (Toolchain) #
#--------------------------------------------#
##############################################
# Copyright (c) 2020 Alexander Barris <awlsomealex at outlook dot com>
# All Rights Reserved
# Licensed under the GNU GPLv3, which can be found at https://www.gnu.org/licenses/gpl-3.0.en.html
#
# Description:  Package compiler and linker metadata toolkit
# URL:          https://github.com/pkgconf/pkgconf
# License:      custom license
# Maintainer:   AwlsomeAlex
# Section:      toolchain (Stage 2)
#

# ----- Package Information ----- #
PKG_NAME=pkgconf
PKG_VERSION=1.6.3
PKG_SRC=("http://distfiles.dereferenced.org/pkgconf/pkgconf-$PKG_VERSION.tar.xz")

# ----- Build Function ----- #
build_pkgconf() {
    
    #-----------------------------#
    # ----- Local Variables ----- #
    #-----------------------------#

    #---------------------------#
    # ----- Configuration ----- #
    #---------------------------#

    # Configure Package
    LDFLAGS="-static" \
    ./configure \
        --prefix="$TFIN_DIR" \
        --with-sysroot="$FIN_DIR" \
        --with-pkg-config-dir="$FIN_DIR/usr/lib/pkgconfig:$FIN_DIR/usr/share/pkgconfig" \
        --with-system-libdir="$FIN_DIR/usr/lib" \
        --with-system-includedir="$FIN_DIR/usr/include"
    
    #-----------------------#
    # ----- Compiling ----- #
    #-----------------------#

    # Compile Package
    make $MAKEFLAGS

    #---------------------#
    # ----- Install ----- #
    #---------------------#
    
    # Install Package to Toolchain Directory
    make install $MAKEFLAGS

    # Symlink pkgconfig
    ln -sf pkgconf "$TFIN_DIR"/bin/pkg-config
    ln -sf pkgconf "$TFIN_DIR"/bin/$XTARGET-pkg-config
    ln -sf pkgconf "$TFIN_DIR"/bin/$XTARGET-pkgconf
}
